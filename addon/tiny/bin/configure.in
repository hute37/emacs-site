dnl
dnl Process this file with "autoconf(1)" to produce a "configure" script.
dnl

AC_INIT(../lisp/tiny/tinylib.el)
AC_SET_MAKE
AC_PATH_PROGS(PERL, perl perl5)
AC_PROG_INSTALL


dnl
dnl Apparently, if you run a shell window in Emacs, it sets the EMACS
dnl environment variable to 't'.  Lets undo the damage.
dnl
if test "${EMACS}" = "t"; then
   EMACS=""
fi


AC_ARG_WITH(xemacs,[  --with-xemacs           Use XEmacs to build],
	[ if test "${withval}" = "yes"; then EMACS=xemacs; else EMACS=${withval}; fi ])
AC_ARG_WITH(emacs,[  --with-emacs            Use Emacs to build],
	[ if test "${withval}" = "yes"; then EMACS=emacs; else EMACS=${withval}; fi ])


echo Checking Emacs or XEmacs...

AC_CHECK_PROGS(EMACS, emacs xemacs,dnl
  AC_MSG_ERROR('Cannot find emacs in your path.
Hint: Try setting EMACS environment variable or fixing your PATH.'))


AC_PATH_LISPDIR
AC_PATH_ETCDIR

lispdir='${datadir}/emacs/site-lisp'
AC_SUBST(lispdir)

srcdirpath=../lisp/tiny
AC_SUBST(srcdirpath)


AC_OUTPUT(Makefile ../lisp/tiny/Makefile ../lisp/other/Makefile)


AC_MSG_RESULT(" ")
AC_MSG_RESULT("Sucessfully configured package")
if test -n "$EMACS_PACKAGE_DIR"; then
   AC_MSG_RESULT("Using package root:                ${EMACS_PACKAGE_DIR}")
fi
AC_MSG_RESULT("Package will be compiled with:    ${EMACS}")
AC_MSG_RESULT(" ")
AC_MSG_RESULT("To finish building type 'make' now.")
AC_MSG_RESULT("To install type 'make install'.")
